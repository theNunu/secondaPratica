<head>
    <meta charset="UTF-8">
    <title>DevSite</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">

    <!-- CSS -->
    <link rel="stylesheet" href="/src/views/components/prueba-1/css/paginacion_dos.css">
    <script src="script.js"></script>

</head>

<body>
    <pasos-avanzar primerPaso="1"></pasos-avanzar>

    <script>
        class PasosAvanzar extends HTMLElement {
            constructor() {
                super();
                this.attachShadow({ mode: "open" });
                // Paso inicial (por defecto 1)
                this.contador = parseInt(this.getAttribute("primerPaso")) || 1;
            }

            connectedCallback() {
                this.actualizarVista();
            }

            // Esta funci√≥n centraliza el "limpiar y pintar" üîÑ
            actualizarVista() {
                this.render();
                this.setupEvents();
            }

            setupEvents() {
                const btnSiguiente = this.shadowRoot.querySelector('#btn-subir');
                const btnAnterior = this.shadowRoot.querySelector('#btn-bajar');

                btnSiguiente.addEventListener('click', () => {
                    if (this.contador < 5) {
                        this.contador++;
                        this.actualizarVista(); // Re-renderizamos al cambiar el dato
                    }
                });

                btnAnterior.addEventListener('click', () => {
                    if (this.contador > 1) {
                        this.contador--;
                        this.actualizarVista(); // Re-renderizamos al cambiar el dato
                    }
                });
            }

            render() {
                // 1. Generamos las 5 barritas din√°micamente üìè
                let barrasHTML = '';
                for (let i = 1; i <= 5; i++) {
                    // Si el √≠ndice es menor o igual al contador, es roja. Si no, blanca.
                    const claseColor = (i <= this.contador) ? 'bg-danger' : 'bg-white border border-danger';
                    barrasHTML += `<div class="rounded ${claseColor}" style="width: 60px; height: 10px;"></div>`;
                }

                // 2. Inyectamos el HTML al Shadow DOM
                this.shadowRoot.innerHTML = `
                <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
                <style>
                    .contenedor-barras { 
                        display: flex; 
                        justify-content: space-between; 
                        width: 350px; 
                        margin: 20px 0; 
                    }
                    .info-paso { font-weight: bold; margin-bottom: 15px; }
                </style>

                <div class="p-4">
                    <div class="contenedor-barras">
                        ${barrasHTML}
                    </div>

                    <div class="info-paso text-danger text-center" style="width: 350px;">
                        Paso ${this.contador} de 5
                    </div>

                    <div class="d-flex gap-2">
                        <button id="btn-bajar" class="btn btn-outline-danger">Anterior</button>
                        <button id="btn-subir" class="btn btn-danger">Siguiente</button>
                    </div>
                </div>
                `;
            }
        }

        customElements.define("pasos-avanzar", PasosAvanzar);
    </script>
</body>

</html>